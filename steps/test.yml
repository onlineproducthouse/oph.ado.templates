parameters:
  - name: projectName
    type: string

  - name: testType
    type: string
    default: unit
    values:
      - unit
      - int

  - name: awsRegion
    type: string
    default: ci

  # semi-colon separated list, e.g. "path1;path2;..."
  - name: awsSSMParamPath
    type: string

  - name: ciFolder
    type: string
    default: ci

  - name: loadEnvVarScriptUrl
    type: string

  - name: script
    type: string

steps:
  - template: ./load-env-vars.yml
    parameters:
      projectName: ${{ parameters.projectName }}
      awsRegion: ${{ parameters.awsRegion }}
      awsSSMParamPath: ${{ parameters.awsSSMParamPath }}
      ciFolder: ${{ parameters.ciFolder }}
      loadEnvVarScriptUrl: ${{ parameters.loadEnvVarScriptUrl }}

  - displayName: ${{ parameters.testType }} test - ${{ parameters.projectName }}
    script: ${{ parameters.script }}
